<!DOCTYPE html>
<html>
<head>
  <title>Reproducir Playlist de YouTube</title>
</head>
<body>

  <video id="videoPlayer" controls crossorigin="anonymous" hidden>
    <source src="..." type="video/mp4">
  </video>

  <script>
    // Crea el elemento iframe
    let player; 
    // ID de los primeros 3 videos
    const videoIds = ['3yiVDrX6vG0', 'CrzGdIOqOJM', 'cmpRLQZkTb8']; 
    let currentVideoIndex = 0;
    // URL de la playlist
    const playlistUrl = 'https://www.youtube.com/playlist?list=PLk6yrJCXLVNGubc2vSTn85x4wxf2DNo0J&key=AIzaSyABAbMEP_2fcPg3m5ULfk51Unf_SmaHl3w';
    let nextVideo;
    
    function createPlayer() {
      player = document.createElement('iframe');
      player.width = 560;
      player.height = 315;
      player.src = `https://www.youtube.com/embed/${videoIds[currentVideoIndex]}?autoplay=1`; //'https://www.youtube.com/embed/' + videoIds[currentVideoIndex]; player.src = 
      document.body.appendChild(player);
    }

    loadVideo(videoIds[currentVideoIndex]);
      
    let checkVideoInterval;

    function checkVideoPlaying() {

      // Verifica si el video está reproduciéndose 
      if(player.currentTime === 0  || player.paused) {
        clearInterval(checkVideoInterval);
        console.log('Iniciando intervalo'); 
        console.log(checkVideoInterval);
        loadNextVideo();
      }

    }

    /*function playVideo() {
      player.play();
    }*/

    function loadNextVideo() {
      // obtén siguiente video
      currentVideoIndex++;
      // asigna siguiente video a player
      loadVideo(videoIds[currentVideoIndex]);
      // Reinicia el timer
      checkVideoInterval = setInterval(checkVideoPlaying, 2000);
      console.log('Iniciando intervalo'); 
      console.log(checkVideoInterval);
    }
    
    function loadVideo(videoId) {
      if (player) {
        player.remove(); 
      }
    
      createPlayer(); 

      // Inicia el timer
      checkVideoInterval = setInterval(checkVideoPlaying, 2000);
      console.log('Iniciando intervalo'); 
      console.log(checkVideoInterval);
    }
  </script>

</body>
</html>
